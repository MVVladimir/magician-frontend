(this["webpackJsonpmagician-frontend"]=this["webpackJsonpmagician-frontend"]||[]).push([[0],{129:function(t,e){},130:function(t,e){},131:function(t,e){},132:function(t,e){},133:function(t,e){},134:function(t,e){},135:function(t,e){},136:function(t,e,n){},201:function(t,e,n){},202:function(t,e,n){},203:function(t,e,n){},204:function(t,e,n){},232:function(t,e,n){"use strict";n.r(e);var s=n(0),c=n.n(s),o=n(22),a=n.n(o),i=(n(88),n(14)),r=n(15),l=n(17),u=n(16),d=n(44),h=n(10),f=(n(28),n(9)),j=n.n(f),b=n(25),x=n(3),g=(c.a.Component,n(30)),p=n.n(g),m="https://magicianapp.herokuapp.com";function O(){return(O=Object(b.a)(j.a.mark((function t(e){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.get("".concat(m,"/nodes/").concat(e));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var v,y,k,S,z=function(t){return O.apply(this,arguments)},C=n(43),w=n(32),L=n(81),A=n(18),T=(n(63),n(136),function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(i.a)(this,n),e.call(this,t)}return Object(r.a)(n,[{key:"render",value:function(){return Object(x.jsxs)(h.Row,{className:"centerInd",children:[Object(x.jsx)(A.Toast,{text:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0435\u0439: ".concat(this.props.lives,"\ud83d\udc96")}),Object(x.jsx)(A.Toast,{text:"\u041c\u0430\u043d\u0430: ".concat(this.props.mana,"\ud83e\uddd9")}),Object(x.jsx)(A.Toast,{text:"\u0421\u043b\u0430\u0432\u0430: ".concat(this.props.glory,"\ud83c\udfba")})]})}}]),n}(c.a.Component)),M=(n(201),n(202),n(203),n(204),1e5),N=3,R=50,B=50,_=0,E=[],F={backgroundImage:""},D=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var s,c;return Object(i.a)(this,n),s=e.call(this,t),console.log("constructor"),s.state={notes:[],scene:null,backgroundImage:{background:""}},s.assistant=(c=function(){return s.getStateForAssistant()},Object(d.a)({getState:c})),s.assistant.on("data",(function(t){switch(t.type){case"character":v=t.character.id,console.log("CHARACTER= ",v);case"action":console.log("assistant.on(data)",t);var e=t.action;s.dispatchAssistantAction(e)}})),s.assistant.on("start",(function(t){console.log("assistant.on(start)",t)})),s}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=Object(b.a)(j.a.mark((function t(){var e,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("componentDidMount"),t.next=3,z(0);case 3:e=t.sent,console.log(e),(n=e.data).nodesArr&&(y=n.nodesArr,console.log("nodesArr",y),k=y.slice()),this.setState({scene:n}),this.read();case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getStateForAssistant",value:function(){console.log("getStateForAssistant: this.state:",this.state);var t={item_selector:{items:{text:this.state.scene.text,texts:this.state.scene.texts,texta:this.state.scene.texta,textj:this.state.scene.textj}}};return console.log("getStateForAssistant: state:",t),t}},{key:"dispatchAssistantAction",value:function(t){if(console.log("dispatchAssistantAction",t),t)switch(t.type){case"add_note":return console.log("add_note",t,"action.choice = ",t.choice),this.add_note(t);case"read":return this.read()}}},{key:"read",value:function(){this.assistant.sendData({action:{action_id:"read"}})}},{key:"sendException",value:function(){this.assistant.sendData({action:{action_id:"noMatch"}})}},{key:"add_note",value:function(t){var e=this,n=t.choice,s=!1;n=n.toLowerCase(),console.log(n),"\u043e\u0434\u0438\u043d"!=n&&"\u043f\u0435\u0440\u0432\u044b\u0439"!=n&&"\u043f\u0435\u0440\u0432\u043e\u0435"!=n&&"\u043f\u0435\u0440\u0432\u0443\u044e"!=n||(n=1),"\u0434\u0432\u0430"!=t.choice&&"\u0432\u0442\u043e\u0440\u043e\u0439"!=n&&"\u0432\u0442\u043e\u0440\u043e\u0435"!=n&&"\u0432\u0442\u043e\u0440\u0443\u044e"!=n||(n=2),"\u0442\u0440\u0438"!=t.choice&&"\u0442\u0440\u0435\u0442\u0438\u0439"!=n&&"\u0442\u0440\u0435\u0442\u044c\u0435"!=n&&"\u0442\u0440\u0435\u0442\u044c\u044e"!=n||(n=3),"\u0447\u0435\u0442\u044b\u0440\u0435"!=t.choice&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u044b\u0439"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u043e\u0435"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u0443\u044e"!=n||(n=4),this.state.scene.options.forEach((function(t,c){t.text.toLowerCase()!==n&&c+1!==n||(e.moveTo(t.id),s=!0)})),s||this.sendException()}},{key:"setBackgrounds",value:function(t){E.push(t);var e="";E.reverse(),E.forEach((function(t,n){e+="url(".concat(m,"/").concat(t,".png) center no-repeat"),n<E.length-1&&(e+=",")})),this.setState({backgroundImage:{background:e}}),E.reverse()}},{key:"moveTo",value:function(t){var e=this;if((N<=0||R<=0||B<=0)&&99999!=this.state.scene.id&&(t=99999),N>0&&R>=200&&B>=200&&this.state.scene.id!=M&&(t=M),console.log("NEXT IS ",t),console.log("ARRAY = ",k),!t){0==k.length&&(console.log("NODES ARR = ",y),k=y.slice());var n=t=Math.floor(Math.random()*k.length);t=k[t],k.splice(n,1),console.log(k)}(0==t||1==t)&&this.state.scene.id>1&&(F.backgroundImage="",k=y,_=0,N=3,R=50,B=50),z(t).then((function(t){var n=t.data;n.bonus&&(N+=n.bonus.lives,R+=n.bonus.mana,B+=n.bonus.glory),e.setState({scene:n}),e.read(),_++,console.log("COUNTER = ",_),_>0&&n.img&&e.setBackgrounds(n.img)}))}},{key:"neededText",value:function(t){return t.text?t.text:"joy"===v?t.textj:"eva"===v?t.texta:t.texts}},{key:"render",value:function(){var t=this,e=this.state,n=e.scene,s=e.backgroundImage;return n?n.options?0==_?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(h.Col,{type:"calc",offsetS:1,offsetM:2,offsetL:3,offsetXL:4,sizeS:1,sizeM:2,sizeL:3,sizeXL:4}),Object(x.jsxs)(A.Headline1,{children:[" ",this.neededText(n)," "]}),n.options.map((function(e){return Object(x.jsx)(h.Row,{children:Object(x.jsx)(w.Button,{style:{marginBottom:"1rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return t.add_note({choice:e.text})},children:e.text})})}))]}):_<7?Object(x.jsxs)(h.Row,{children:[Object(x.jsx)(h.Col,{className:"centerPic",children:Object(x.jsx)("div",{style:s,className:"img-Wrapper"})}),Object(x.jsxs)(h.Col,{className:"centerBut",type:"rel",offsetS:0,offsetM:0,offsetL:1,offsetXL:0,sizeS:4,sizeM:6,sizeL:6,sizeXL:6,children:[Object(x.jsxs)(A.Headline1,{className:"centerText",children:[" ",this.neededText(n)," "]}),n.options.map((function(e){return Object(x.jsx)(h.Row,{type:"rel",sizeS:4,sizeM:6,sizeL:6,sizeXL:6,children:Object(x.jsx)(w.Button,{style:{marginBottom:"1rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return t.add_note({choice:e.text})},children:e.text})})}))]})]}):Object(x.jsxs)(h.Row,{children:[Object(x.jsx)(h.Col,{className:"centerPic",children:Object(x.jsx)("div",{style:s,className:"img-Wrapper"})}),Object(x.jsxs)(h.Col,{className:"centerBut",type:"rel",offsetS:0,offsetM:0,offsetL:1,offsetXL:0,sizeS:4,sizeM:6,sizeL:6,sizeXL:6,children:[Object(x.jsxs)(A.Headline1,{className:"centerText",children:[" ",this.neededText(n)," "]}),Object(x.jsx)(T,{lives:N,mana:R,glory:B}),n.options.map((function(e){return Object(x.jsx)(h.Row,{type:"rel",sizeS:4,sizeM:6,sizeL:6,sizeXL:6,children:Object(x.jsx)(w.Button,{style:{marginBottom:"1rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return t.add_note({choice:e.text})},children:e.text})})}))]})]}):void 0:Object(x.jsx)(L.Spinner,{})}}]),n}(c.a.Component),I=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return console.log("render"),Object(x.jsx)(h.Container,{children:Object(x.jsx)(D,{})})}}]),n}(c.a.Component),X=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,235)).then((function(e){var n=e.getCLS,s=e.getFID,c=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),s(t),c(t),o(t),a(t)}))},P=n(83),H=n(82),U=n(1),G=n(2),J=Object(U.createGlobalStyle)(S||(S=Object(H.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),G.text,G.background,G.gradient),W=Object(U.createGlobalStyle)(C.darkSber),Y=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(J,{}),Object(x.jsx)(W,{})]})};a.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsxs)(P.DeviceThemeProvider,{children:[Object(x.jsx)(Y,{}),Object(x.jsx)(I,{})]})}),document.getElementById("root")),X()},28:function(t,e,n){},64:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=64},88:function(t,e,n){}},[[232,1,2]]]);
//# sourceMappingURL=main.bbfa9171.chunk.js.map