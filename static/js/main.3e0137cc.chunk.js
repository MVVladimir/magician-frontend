(this["webpackJsonpmagician-frontend"]=this["webpackJsonpmagician-frontend"]||[]).push([[0],{130:function(e,t){},131:function(e,t){},132:function(e,t){},133:function(e,t){},134:function(e,t){},135:function(e,t){},136:function(e,t){},137:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},238:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),o=n(21),a=n.n(o),i=(n(89),n(14)),r=n(15),l=n(17),u=n(16),h=n(44),d=n(10),f=(n(28),n(9)),j=n.n(f),p=n(24),x=n(2),g=(c.a.Component,n(30)),b=n.n(g),O="https://magicianapp.herokuapp.com";function m(){return(m=Object(p.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(O,"/nodes/").concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v,y,k,S,N=function(e){return m.apply(this,arguments)},T=n(43),w=n(32),z=n(82),A=n(25),C=(n(63),n(137),n(65),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(r.a)(n,[{key:"render",value:function(){return Object(x.jsxs)(d.Row,{className:"centerInd",children:[Object(x.jsxs)("div",{className:"indWrapper",children:[" ",Object(x.jsx)(A.Toast,{text:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0435\u0439: ".concat(this.props.lives,"\ud83d\udc96")})," "]}),Object(x.jsxs)("div",{className:"indWrapper",children:[" ",Object(x.jsx)(A.Toast,{text:"\u041c\u0430\u043d\u0430: ".concat(this.props.mana,"\ud83e\uddd9")})," "]}),Object(x.jsxs)("div",{className:"indWrapper",children:[" ",Object(x.jsx)(A.Toast,{text:"\u0421\u043b\u0430\u0432\u0430: ".concat(this.props.glory,"\ud83c\udfba")})," "]})]})}}]),n}(c.a.Component)),R=(n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),1e5),L=!1,E=3,M=50,I=50,P=0,D=[],_={backgroundImage:""},B=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var s,c;return Object(i.a)(this,n),s=t.call(this,e),console.log("constructor"),s.state={notes:[],scene:null,backgroundImage:{background:""}},s.assistant=(c=function(){return s.getStateForAssistant()},Object(h.a)({getState:c})),s.assistant.on("data",(function(e){switch(e.type){case"character":v=e.character.id,s.setState({scene:s.state.scene,character:v}),console.log("CHARACTER= ",v)}console.log("assistant.on(data)",e);var t=e.action;s.dispatchAssistantAction(t)})),s.assistant.on("start",(function(e){console.log("assistant.on(start)",e)})),s}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("componentDidMount"),e.next=3,N(0);case 3:t=e.sent,console.log(t),(n=t.data).nodesArr&&(y=n.nodesArr.slice(0,n.nodesArr.length),console.log("nodesArr",y),k=y.slice(0,y.length)),this.setState({scene:n,character:v}),this.read();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getStateForAssistant",value:function(){console.log("getStateForAssistant: this.state:",this.state);var e,t,n={item_selector:{items:{text:this.state.scene.text,texts:this.state.scene.texts,texta:this.state.scene.texta,textj:this.state.scene.textj,userSuggest:this.state.scene.options[(e=0,t=this.state.scene.options.length,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e)].text[0]}}};return console.log("getStateForAssistant: state:",n),n}},{key:"dispatchAssistantAction",value:function(e){if(console.log("dispatchAssistantAction",e),e)switch(e.type){case"add_note":return console.log("add_note",e,"action.choice = ",e.choice),this.add_note(e);case"read":return this.read();case"newScene":return this.newScene()}}},{key:"exit",value:function(){this.assistant.close()}},{key:"read",value:function(){this.assistant.sendData({action:{action_id:"read"}})}},{key:"newScene",value:function(){this.assistant.sendData({action:{action_id:"newScene"}})}},{key:"sendException",value:function(){this.assistant.sendData({action:{action_id:"noMatch"}})}},{key:"add_note",value:function(e){var t=this,n=e.choice,s=!1;n=n.toLowerCase(),console.log(n),this.state.scene.options[1]&&this.state.scene.options[1].text.includes("\u0432\u044b\u0439\u0442\u0438")&&this.state.scene.options[1].text.includes(n.toLowerCase())&&this.exit(),"\u043e\u0434\u0438\u043d"!=n&&"\u043f\u0435\u0440\u0432\u044b\u0439"!=n&&"\u043f\u0435\u0440\u0432\u043e\u0435"!=n&&"\u043f\u0435\u0440\u0432\u0443\u044e"!=n||(n=1),"\u0434\u0432\u0430"!=e.choice&&"\u0432\u0442\u043e\u0440\u043e\u0439"!=n&&"\u0432\u0442\u043e\u0440\u043e\u0435"!=n&&"\u0432\u0442\u043e\u0440\u0443\u044e"!=n||(n=2),"\u0442\u0440\u0438"!=e.choice&&"\u0442\u0440\u0435\u0442\u0438\u0439"!=n&&"\u0442\u0440\u0435\u0442\u044c\u0435"!=n&&"\u0442\u0440\u0435\u0442\u044c\u044e"!=n||(n=3),"\u0447\u0435\u0442\u044b\u0440\u0435"!=e.choice&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u044b\u0439"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u043e\u0435"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u0443\u044e"!=n||(n=4),this.state.scene.options.forEach((function(e,c){c+1===n&&(t.moveTo(e.id),s=!0),console.log("ARR = "+e.text),e.text.forEach((function(c){c.toLowerCase()===n&&(t.moveTo(e.id),s=!0)}))})),s||this.sendException()}},{key:"setBackgrounds",value:function(e){D.push(e);var t="";D.reverse(),D.forEach((function(e,n){t+="url(".concat(O,"/").concat(e,".png) center no-repeat"),n<D.length-1&&(t+=",")})),this.setState({backgroundImage:{background:t},character:v}),D.reverse()}},{key:"moveTo",value:function(e){var t=this;if(P++,(E<=0||M<=0||I<=0)&&99999!=this.state.scene.id&&(e=99999),E>0&&(M>=200||I>=200)&&this.state.scene.id!=R&&(e=R),console.log("NEXT IS ",e),console.log("ARRAY = ",k),!e)if(0==k.length)if(console.log("NODES ARR = ",y),L){console.log("REPEAT POINT NODES ARR",y),k=y.slice(0,y.length),console.log("REPEAT POINT CUR NODS",k);var n=e=Math.floor(Math.random()*k.length);e=k[e],k.splice(n,1),console.log("NEXT ID = ",e)}else e=12321,L=!0,console.log("REPEAT POINT NODES ARR",y),k=y.slice(0,y.length),console.log("REPEAT POINT CUR NODS",k);else{var s=e=Math.floor(Math.random()*k.length);e=k[e],k.splice(s,1),console.log(k)}1==e&&this.state.scene.id>1&&(_.backgroundImage="",k=y.slice(0,y.length),P=1,E=3,M=50,I=50),N(e).then((function(e){var n=e.data;n.bonus&&(E+=n.bonus.lives,M+=n.bonus.mana,I+=n.bonus.glory),t.setState({scene:n,character:v}),t.newScene(),console.log("COUNTER = ",P),P>0&&n.img&&t.setBackgrounds(n.img)}))}},{key:"neededText",value:function(e){return e.text?e.text:"joy"===v?e.textj:"eva"===v?e.texta:e.texts}},{key:"render",value:function(){var e=this,t=this.state,n=t.scene,s=t.backgroundImage;return n?n.options?0==P?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.Col,{type:"calc",offsetS:1,offsetM:2,offsetL:3,offsetXL:4,sizeS:1,sizeM:2,sizeL:3,sizeXL:4}),Object(x.jsxs)("h1",{className:"textWrapper",children:[" ",this.neededText(n)," "]}),n.options.map((function(t){return Object(x.jsx)(d.Row,{children:Object(x.jsx)(w.Button,{scaleOnInteraction:!1,scaleOnHover:!1,scaleOnPress:!1,style:{marginBottom:"5rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return e.add_note({choice:t.text[0]})},children:Object(x.jsxs)("div",{className:"butTextWrapper",children:[" ",t.text[0]," "]})})})}))]}):P<7?Object(x.jsxs)(d.Row,{className:"rowWrapper",children:[Object(x.jsx)(d.Col,{sizeS:4,sizeM:3,sizeL:4,sizeXL:6,className:"centerPic",children:Object(x.jsx)("div",{style:s,className:"img-Wrapper"})}),Object(x.jsxs)(d.Col,{className:"centerBut",type:"rel",offsetS:0,offsetM:0,offsetL:1,offsetXL:0,sizeS:4,sizeM:3,sizeL:3,sizeXL:6,children:[Object(x.jsxs)("h1",{className:"centerText",children:[" ",this.neededText(n)," "]}),n.options.map((function(t){return Object(x.jsx)(d.Row,{children:Object(x.jsx)(w.Button,{scaleOnInteraction:!1,scaleOnHover:!1,scaleOnPress:!1,style:{marginBottom:"12px",width:"100%"},stretch:!0,size:"s",onClick:function(){return e.add_note({choice:t.text[0]})},children:Object(x.jsxs)("div",{className:"butTextWrapper",children:[" ",t.text[0]," "]})})})}))]})]}):Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(d.Row,{className:"rowWrapper",children:[Object(x.jsx)(d.Col,{sizeS:4,sizeM:3,sizeL:4,sizeXL:6,className:"centerPic",children:Object(x.jsx)("div",{style:s,className:"img-Wrapper"})}),Object(x.jsxs)(d.Col,{className:"centerBut",type:"rel",offsetS:0,offsetM:0,offsetL:1,offsetXL:0,sizeS:4,sizeM:3,sizeL:3,sizeXL:6,children:[Object(x.jsxs)("h1",{className:"centerText",children:[" ",this.neededText(n)," "]}),Object(x.jsx)(C,{lives:E,mana:M,glory:I}),n.options.map((function(t){return Object(x.jsx)(d.Row,{type:"rel",sizeS:4,sizeM:6,sizeL:6,sizeXL:6,children:Object(x.jsx)(w.Button,{scaleOnInteraction:!1,scaleOnHover:!1,scaleOnPress:!1,style:{marginBottom:"12px",width:"100%"},stretch:!0,size:"s",onClick:function(){return e.add_note({choice:t.text[0]})},children:Object(x.jsxs)("div",{className:"butTextWrapper",children:[" ",t.text[0]," "]})})})}))]})]})}):void 0:Object(x.jsx)(z.Spinner,{className:"spinnerWrapper"})}}]),n}(c.a.Component),F=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return console.log("render"),Object(x.jsx)(d.Container,{children:Object(x.jsx)(B,{})})}}]),n}(c.a.Component),W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,241)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),o(e),a(e)}))},X=n(84),U=n(83),H=n(1),G=n(3),J=Object(H.createGlobalStyle)(S||(S=Object(U.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),G.text,G.background,G.gradient),Y=Object(H.createGlobalStyle)(T.darkSber),q=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(J,{}),Object(x.jsx)(Y,{})]})};a.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsxs)(X.DeviceThemeProvider,{children:[Object(x.jsx)(q,{}),Object(x.jsx)(F,{})]})}),document.getElementById("root")),W()},28:function(e,t,n){},64:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=64},65:function(e,t,n){},89:function(e,t,n){}},[[238,1,2]]]);
//# sourceMappingURL=main.3e0137cc.chunk.js.map