(this["webpackJsonpmagician-frontend"]=this["webpackJsonpmagician-frontend"]||[]).push([[0],{128:function(t,e){},129:function(t,e){},130:function(t,e){},131:function(t,e){},132:function(t,e){},133:function(t,e){},134:function(t,e){},199:function(t,e,n){},226:function(t,e,n){"use strict";n.r(e);var o=n(0),c=n.n(o),s=n(21),a=n.n(s),r=(n(86),n(14)),i=n(15),u=n(17),l=n(16),d=n(43),h=n(12),j=(n(29),n(9)),b=n.n(j),g=n(24),f=n(3),p=(c.a.Component,n(31)),O=n.n(p),x="https://magicianapp.herokuapp.com";function v(){return(v=Object(g.a)(b.a.mark((function t(e){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("".concat(x,"/nodes/").concat(e));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m,k=function(t){return v.apply(this,arguments)},y=n(25),w=n(50),S=n(28),C=(n(127),function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){return Object(r.a)(this,n),e.call(this,t)}return Object(i.a)(n,[{key:"render",value:function(){return Object(f.jsxs)(h.Row,{children:[Object(f.jsx)(S.Toast,{text:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0435\u0439: ".concat(this.props.lives,"\ud83d\udc96")}),Object(f.jsx)(S.Toast,{text:"\u041c\u0430\u043d\u0430 \u0441\u0432\u0435\u0442\u0430: ".concat(this.props.light,"\u2600")}),Object(f.jsx)(S.Toast,{text:"\u041c\u0430\u043d\u0430 \u0442\u044c\u043c\u044b: ".concat(this.props.darkness,"\ud83d\udc80")}),Object(f.jsx)(S.Toast,{text:"\u0421\u043b\u0430\u0432\u0430: ".concat(this.props.glory,"\ud83c\udfba")})]})}}]),n}(c.a.Component)),T=(n(199),3),A=50,F=50,_=50,B=0,I=[],D=[100],E=[100],M={backgroundImage:""},N=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var o,c;return Object(r.a)(this,n),o=e.call(this,t),console.log("constructor"),o.state={notes:[],scene:null,backgroundImage:{background:""}},o.assistant=(c=function(){return o.getStateForAssistant()},Object(d.a)({getState:c})),o.assistant.on("data",(function(t){console.log("assistant.on(data)",t);var e=t.action;o.dispatchAssistantAction(e)})),o.assistant.on("start",(function(t){console.log("assistant.on(start)",t)})),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var t=Object(g.a)(b.a.mark((function t(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("componentDidMount"),t.next=3,k(0);case 3:e=t.sent,console.log(e),n=e.data,this.setState({scene:n}),this.read();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getStateForAssistant",value:function(){console.log("getStateForAssistant: this.state:",this.state);var t={item_selector:{items:{text:this.state.scene.text}}};return console.log("getStateForAssistant: state:",t),t}},{key:"dispatchAssistantAction",value:function(t){if(console.log("dispatchAssistantAction",t),t)switch(t.type){case"add_note":return console.log("add_note",t,"action.choice = ",t.choice),this.add_note(t);case"read":return this.read()}}},{key:"read",value:function(){this.assistant.sendData({action:{action_id:"read"}})}},{key:"add_note",value:function(t){var e=this,n=t.choice;console.log(n),"\u043e\u0434\u0438\u043d"!=n&&"\u043f\u0435\u0440\u0432\u044b\u0439"!=n&&"\u043f\u0435\u0440\u0432\u043e\u0435"!=n&&"\u043f\u0435\u0440\u0432\u0443\u044e"!=n||(n=1),"\u0434\u0432\u0430"!=t.choice&&"\u0432\u0442\u043e\u0440\u043e\u0439"!=n&&"\u0432\u0442\u043e\u0440\u043e\u0435"!=n&&"\u0432\u0442\u043e\u0440\u0443\u044e"!=n||(n=2),"\u0442\u0440\u0438"!=t.choice&&"\u0442\u0440\u0435\u0442\u0438\u0439"!=n&&"\u0442\u0440\u0435\u0442\u044c\u0435"!=n&&"\u0442\u0440\u0435\u0442\u044c\u044e"!=n||(n=3),"\u0447\u0435\u0442\u044b\u0440\u0435"!=t.choice&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u044b\u0439"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u043e\u0435"!=n&&"\u0447\u0435\u0442\u0432\u0435\u0440\u0442\u0443\u044e"!=n||(n=4),this.state.scene.options.forEach((function(t,o){console.log("index = ",o,"choice = ",n),t.text!==n&&o+1!==n||(console.log("movedTo",t.id),e.moveTo(t.id))}))}},{key:"setBackgrounds",value:function(t){I.push(t);var e="";I.reverse(),I.forEach((function(t,n){e+="url(".concat(x,"/").concat(t,".png) center no-repeat"),n<I.length-1&&(e+=",")})),this.setState({backgroundImage:{background:e}}),I.reverse()}},{key:"moveTo",value:function(t){var e=this;0!=T&&0!=F&&0!=_&&0!=A||99999==this.state.scene.id||(t=99999),console.log("NEXT IS ",t),t||(t=Math.floor(Math.random()*E.length),t=E[t]),(0==t||1==t)&&this.state.scene.id>1&&(M.backgroundImage="",E=D,B=1,T=3,A=50,F=50,_=50),k(t).then((function(t){var n=t.data;e.setState({scene:n}),e.read(),++B>0&&n.img&&e.setBackgrounds(n.img),console.log("data",n),n.bonus&&(T+=n.bonus.lives,F+=n.bonus.light,_+=n.bonus.darkness,A+=n.bonus.glory)}))}},{key:"render",value:function(){var t=this,e=this.state,n=e.scene,o=e.backgroundImage;return n?n.options?0==B?Object(f.jsxs)(h.Container,{styles:y.darkSber,children:[Object(f.jsxs)("h1",{children:[" ",n.text," "]}),n.options.map((function(e){return Object(f.jsx)(h.Row,{children:Object(f.jsx)(w.Button,{style:{marginBottom:"1rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return t.add_note({choice:e.text})},children:e.text})})}))]}):Object(f.jsxs)(h.Container,{styles:y.darkSber,children:[Object(f.jsxs)(h.Row,{children:[Object(f.jsx)(h.Col,{type:"calc",size:3,children:Object(f.jsx)("div",{style:o,height:"450",width:"450",className:"img-Wrapper"})}),Object(f.jsxs)(h.Col,{type:"calc",offset:2,size:5,children:[Object(f.jsxs)("h1",{children:[" ",n.text," "]}),n.options.map((function(e){return Object(f.jsx)(h.Row,{children:Object(f.jsx)(w.Button,{style:{marginBottom:"1rem",width:"100%"},stretch:!0,size:"l",onClick:function(){return t.add_note({choice:e.text})},children:e.text})})}))]})]}),console.log("values: ",T," ",F," ",_," ",A),Object(f.jsx)(C,{lives:T,light:F,darkness:_,glory:A})]}):void 0:Object(f.jsx)("h1",{children:"Nothing..."})}}]),n}(c.a.Component),z=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return console.log("render"),Object(f.jsx)(h.Container,{children:Object(f.jsx)(N,{})})}}]),n}(c.a.Component),R=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,229)).then((function(e){var n=e.getCLS,o=e.getFID,c=e.getFCP,s=e.getLCP,a=e.getTTFB;n(t),o(t),c(t),s(t),a(t)}))},L=n(81),P=n(80),G=n(1),J=n(2),U=Object(G.createGlobalStyle)(m||(m=Object(P.a)(["\n    html:root {\n        min-height: 100vh;\n        color: ",";\n        background-color: ",";\n        background-image: ",";\n    }\n"])),J.text,J.background,J.gradient),W=Object(G.createGlobalStyle)(y.darkSber),X=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(U,{}),Object(f.jsx)(W,{})]})};a.a.render(Object(f.jsxs)(c.a.StrictMode,{children:[Object(f.jsxs)(L.DeviceThemeProvider,{children:[Object(f.jsx)(X,{}),Object(f.jsx)(z,{})]}),","]}),document.getElementById("root")),R()},29:function(t,e,n){},63:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=63},86:function(t,e,n){}},[[226,1,2]]]);
//# sourceMappingURL=main.ae6d9155.chunk.js.map